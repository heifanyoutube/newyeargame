<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ä¸€å­—åƒé‡‘ | ç®¡ç†ç«¯</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@500;700;900&family=Orbitron:wght@600;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --primary: #FF6B35;
            --secondary: #F7931E;
            --accent: #FFD23F;
            --correct: #00FF88;
            --incorrect: #FF3366;
            --bg-dark: #0A0E27;
            --bg-gradient: linear-gradient(135deg, #0A0E27 0%, #1a1f3a 50%, #0d1129 100%);
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: var(--bg-gradient);
            color: white;
            overflow-x: hidden;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary), var(--secondary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            color: var(--accent);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .connection-panel {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid var(--primary);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 30px rgba(255, 107, 53, 0.3);
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--accent);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .input-group input {
            width: 100%;
            padding: 15px;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid rgba(255, 107, 53, 0.3);
            border-radius: 10px;
            color: white;
            font-size: 1rem;
            font-family: 'Orbitron', monospace;
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(255, 107, 53, 0.3);
        }

        .btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(255, 107, 53, 0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:active {
            transform: scale(0.98);
            box-shadow: 0 2px 10px rgba(255, 107, 53, 0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-next {
            background: linear-gradient(135deg, #00FF88, #00CC6A);
            margin-bottom: 15px;
            font-size: 1.3rem;
            padding: 25px;
        }

        .status-message {
            text-align: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin-bottom: 20px;
            color: var(--accent);
            font-size: 0.95rem;
        }

        .status-message.connected {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid var(--correct);
            color: var(--correct);
        }

        .control-panel {
            display: none;
        }

        .control-panel.active {
            display: block;
        }

        .question-display {
            background: rgba(255, 107, 53, 0.1);
            border: 2px solid var(--primary);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 30px rgba(255, 107, 53, 0.2);
        }

        .question-label {
            font-size: 0.85rem;
            color: var(--accent);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 700;
            line-height: 1.6;
            color: white;
        }

        .answer-hint {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 107, 53, 0.3);
            color: var(--accent);
            font-size: 1.1rem;
        }

        .answer-hint strong {
            color: var(--correct);
            font-size: 1.5rem;
            font-weight: 900;
        }

        .players-status {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(255, 107, 53, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(255, 107, 53, 0.05);
            border-radius: 10px;
            margin-bottom: 10px;
            border: 1px solid rgba(255, 107, 53, 0.2);
        }

        .player-item.appeal {
            background: rgba(255, 211, 63, 0.2);
            border-color: var(--accent);
            animation: appeal-pulse 1s infinite;
        }

        @keyframes appeal-pulse {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 211, 63, 0.5); }
            50% { box-shadow: 0 0 40px rgba(255, 211, 63, 0.8); }
        }

        .player-name {
            font-weight: 700;
            color: var(--primary);
        }

        .player-answer {
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
        }

        .override-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .btn-small {
            padding: 10px 20px;
            font-size: 0.9rem;
            border-radius: 8px;
            flex: 1;
        }

        .btn-correct {
            background: linear-gradient(135deg, var(--correct), #00CC6A);
        }

        .btn-incorrect {
            background: linear-gradient(135deg, var(--incorrect), #CC1144);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            transition: width 0.3s ease;
            box-shadow: 0 0 10px var(--primary);
        }

        .stats {
            display: flex;
            justify-content: space-around;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-family: 'Orbitron', monospace;
            font-size: 2rem;
            font-weight: 900;
            color: var(--accent);
            text-shadow: 0 0 15px var(--accent);
        }

        .stat-label {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .appeal-badge {
            display: inline-block;
            background: var(--accent);
            color: var(--bg-dark);
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 700;
            margin-left: 10px;
            animation: badge-pulse 0.5s infinite;
        }

        @keyframes badge-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">ç®¡ç†ç«¯</div>
            <div class="subtitle">ä¸€å­—åƒé‡‘ â€§ æ´¾å°çˆ­éœ¸</div>
        </div>

        <div id="connectionPanel" class="connection-panel">
            <div class="input-group">
                <label>è¼¸å…¥ä¸»æ§ç«¯ IDï¼ˆ4 ä½æ•¸å­—ï¼‰</label>
                <input type="number" id="hostIdInput" placeholder="ä¾‹å¦‚ï¼š1234" pattern="[0-9]*" inputmode="numeric" maxlength="4" autofocus>
            </div>
            <button class="btn" id="connectBtn">é€£ç·šè‡³ä¸»æ§ç«¯</button>
            <div class="status-message" id="statusMessage">ç­‰å¾…é€£ç·š...</div>
        </div>

        <div id="controlPanel" class="control-panel">
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="currentQuestion">0</div>
                    <div class="stat-label">ç›®å‰é¡Œè™Ÿ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">100</div>
                    <div class="stat-label">ç¸½é¡Œæ•¸</div>
                </div>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progressBar" style="width: 0%"></div>
            </div>

            <button class="btn btn-next" id="nextQuestionBtn">
                â–¶ ä¸‹ä¸€é¡Œ
            </button>

            <div class="question-display" id="questionDisplay" style="display: none;">
                <div class="question-label">ç•¶å‰é¡Œç›®</div>
                <div class="question-text" id="questionText"></div>
                <div class="answer-hint">
                    æ­£ç¢ºç­”æ¡ˆï¼š<strong id="correctAnswer"></strong>
                </div>
            </div>

            <div class="players-status">
                <h3 style="margin-bottom: 15px; color: var(--accent); font-size: 1rem; text-transform: uppercase; letter-spacing: 1px;">é¸æ‰‹ç‹€æ…‹</h3>
                
                <div class="player-item" id="player1Status">
                    <div>
                        <span class="player-name">é¸æ‰‹ 1</span>
                        <span class="appeal-badge" id="appeal1" style="display: none;">ğŸ”” è«‹æ±‚å¯©æ ¸</span>
                    </div>
                    <div class="player-answer" id="answer1">---</div>
                    <div class="override-buttons" id="override1" style="display: none;">
                        <button class="btn btn-small btn-correct" onclick="overridePlayer(1, true)">âœ“ æ­£ç¢º</button>
                        <button class="btn btn-small btn-incorrect" onclick="overridePlayer(1, false)">âœ— éŒ¯èª¤</button>
                    </div>
                </div>

                <div class="player-item" id="player2Status">
                    <div>
                        <span class="player-name">é¸æ‰‹ 2</span>
                        <span class="appeal-badge" id="appeal2" style="display: none;">ğŸ”” è«‹æ±‚å¯©æ ¸</span>
                    </div>
                    <div class="player-answer" id="answer2">---</div>
                    <div class="override-buttons" id="override2" style="display: none;">
                        <button class="btn btn-small btn-correct" onclick="overridePlayer(2, true)">âœ“ æ­£ç¢º</button>
                        <button class="btn btn-small btn-incorrect" onclick="overridePlayer(2, false)">âœ— éŒ¯èª¤</button>
                    </div>
                </div>

                <div class="player-item" id="player3Status">
                    <div>
                        <span class="player-name">é¸æ‰‹ 3</span>
                        <span class="appeal-badge" id="appeal3" style="display: none;">ğŸ”” è«‹æ±‚å¯©æ ¸</span>
                    </div>
                    <div class="player-answer" id="answer3">---</div>
                    <div class="override-buttons" id="override3" style="display: none;">
                        <button class="btn btn-small btn-correct" onclick="overridePlayer(3, true)">âœ“ æ­£ç¢º</button>
                        <button class="btn btn-small btn-incorrect" onclick="overridePlayer(3, false)">âœ— éŒ¯èª¤</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const QUESTIONS = [
            {"q": "è«‹å¯«å‡ºã€Œã„¨ã„¢Ë‡ã€æ•‘çš„ã€Œã„¨ã„¢Ë‡ã€", "a": "æŒ½"},
            {"q": "ã€Œå†æ¥å†å²ã€çš„ã€Œå²ã€æ˜¯å¦æ­£ç¢ºï¼Ÿ(è«‹å¯«æ­£å­—)", "a": "å²"},
            {"q": "ã€Œå¯’æš„ã€çš„ã€Œæš„ã€æ€éº¼å¯«ï¼Ÿ", "a": "æš„"},
            {"q": "è«‹å¯«å‡ºã€Œå°·å°¬ã€çš„ã€Œå°¬ã€", "a": "å°¬"},
            {"q": "æˆèªå¡«ç©ºï¼šæŒ‰éƒ¨ã€Œã€‡ã€ç­", "a": "å°±"},
            {"q": "ã€Œã„’ã„©ã„¢ËŠã€æŸ“çš„ã€Œã„’ã„©ã„¢ËŠã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "æ¸²"},
            {"q": "è«‹å¯«å‡ºã€Œå½†æ‰­ã€çš„ã€Œå½†ã€", "a": "å½†"},
            {"q": "ã€Œã„“Ë‹ã€æ¯è¬è®Šçš„ã€Œã„“Ë‹ã€æ€éº¼å¯«ï¼Ÿ", "a": "ç¬"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€ç«¿è¦‹å½±", "a": "ç«‹"},
            {"q": "ã€Œã„Œã„§ã„ ËŠã€é—Šçš„ã€Œã„Œã„§ã„ ËŠã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "é¼"},
            {"q": "è«‹å¯«å‡ºã€Œè¹£è·šã€çš„ã€Œè¹£ã€", "a": "è¹£"},
            {"q": "ã€Œå«»ã€ç†Ÿçš„ã€Œå«»ã€æ€éº¼å¯«ï¼Ÿ", "a": "å«»"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€ç²¾æœƒç¥", "a": "èš"},
            {"q": "ã€Œã„ã„§ã„ËŠã€ç„¶ä¸åŒçš„ã€Œã„ã„§ã„ËŠã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "è¿¥"},
            {"q": "è«‹å¯«å‡ºã€Œæ‡¾ã€æœçš„ã€Œæ‡¾ã€", "a": "æ‡¾"},
            {"q": "ã€Œã„‘ã„§Ë‹ã€è€Œä¸æ¨çš„ã€Œã„‘ã„§Ë‹ã€æ€éº¼å¯«ï¼Ÿ", "a": "å¥‘"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€æ‰‹å¯å¾—", "a": "å”¾"},
            {"q": "ã€Œã„’ã„©ã„¢ã€å˜©çš„ã€Œã„’ã„©ã„¢ã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "å–§"},
            {"q": "è«‹å¯«å‡ºã€Œæ…·æ…¨ã€çš„ã€Œæ…¨ã€", "a": "æ…¨"},
            {"q": "ã€Œæƒ†æ‚µã€çš„ã€Œæƒ†ã€æ€éº¼å¯«ï¼Ÿ", "a": "æƒ†"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€ç„¶å¤§æ‚Ÿ", "a": "æ"},
            {"q": "ã€Œã„†ã„§Ë‡ã€ç¨çš„ã€Œã„†ã„§Ë‡ã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "ç¥"},
            {"q": "è«‹å¯«å‡ºã€Œè¹™ã€é¡çš„ã€Œè¹™ã€", "a": "è¹™"},
            {"q": "ã€Œã„…ã„§Ë‹ã€ç«¯çš„ã€Œã„…ã„§Ë‹ã€æ€éº¼å¯«ï¼Ÿ", "a": "å¼Š"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€å¼µè²å‹¢", "a": "è™›"},
            {"q": "ã€Œã„”ã„¢ËŠã€æ‚”çš„ã€Œã„”ã„¢ËŠã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "æ‡º"},
            {"q": "è«‹å¯«å‡ºã€Œå˜²è«·ã€çš„ã€Œè«·ã€", "a": "è«·"},
            {"q": "ã€Œæ€ æƒ°ã€çš„ã€Œæƒ°ã€æ€éº¼å¯«ï¼Ÿ", "a": "æƒ°"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€é£›çŒ›é€²", "a": "çª"},
            {"q": "ã€Œã„’ã„§ã„Ë‹ã€æ¸çš„ã€Œã„’ã„§ã„Ë‹ã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "è¤»"},
            {"q": "è«‹å¯«å‡ºã€Œè¨•ç¬‘ã€çš„ã€Œè¨•ã€", "a": "è¨•"},
            {"q": "ã€Œã„‰ã„§ã„ËŠã€ç›ªçš„ã€Œã„‰ã„§ã„ËŠã€æ€éº¼å¯«ï¼Ÿ", "a": "è·Œ"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€æœ¨æ±‚é­š", "a": "ç·£"},
            {"q": "ã€Œã„Œã„§ã„£ËŠã€æ†«çš„ã€Œã„Œã„§ã„£ËŠã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "æ†"},
            {"q": "è«‹å¯«å‡ºã€Œå«‰å¦’ã€çš„ã€Œå«‰ã€", "a": "å«‰"},
            {"q": "ã€Œè­è«·ã€çš„ã€Œè­ã€æ€éº¼å¯«ï¼Ÿ", "a": "è­"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€è¡·å…±æ¿Ÿ", "a": "åŒ"},
            {"q": "ã€Œã„“ã„œËŠã€ç£¨çš„ã€Œã„“ã„œËŠã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "æŠ˜"},
            {"q": "è«‹å¯«å‡ºã€Œæ…°è—‰ã€çš„ã€Œè—‰ã€", "a": "è—‰"},
            {"q": "ã€Œã„‹ã„§ã„Ë‹ã€æ‰‹ã„‹ã„§ã„Ë‹è…³çš„ã€Œã„‹ã„§ã„Ë‹ã€æ€éº¼å¯«ï¼Ÿ", "a": "èº¡"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€é€”æœ«è·¯", "a": "çª®"},
            {"q": "ã€Œã„ã„¨ã„ŸË‹ã€æ¾€çš„ã€Œã„ã„¨ã„ŸË‹ã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "æ™¦"},
            {"q": "è«‹å¯«å‡ºã€Œç‘•ç–µã€çš„ã€Œç–µã€", "a": "ç–µ"},
            {"q": "ã€Œè©­ã€è¾¯çš„ã€Œè©­ã€æ€éº¼å¯«ï¼Ÿ", "a": "è©­"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€æ¥µæ³°ä¾†", "a": "å¦"},
            {"q": "ã€Œã„ã„§ã„¢Ë‡ã€æ¨¸çš„ã€Œã„ã„§ã„¢Ë‡ã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "å„‰"},
            {"q": "è«‹å¯«å‡ºã€Œæ¶æ„ã€çš„ã€Œæ„ã€", "a": "æ„"},
            {"q": "ã€Œæ–Ÿé…Œã€çš„ã€Œé…Œã€æ€éº¼å¯«ï¼Ÿ", "a": "é…Œ"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€ç“œçˆ›ç†Ÿ", "a": "æ»¾"},
            {"q": "ã€Œã„†ã„§ã„¢ËŠã€ç¥–çš„ã€Œã„†ã„§ã„¢ËŠã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "é§¢"},
            {"q": "è«‹å¯«å‡ºã€Œç™–å¥½ã€çš„ã€Œç™–ã€", "a": "ç™–"},
            {"q": "ã€Œè«‚åªšã€çš„ã€Œè«‚ã€æ€éº¼å¯«ï¼Ÿ", "a": "è«‚"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€ç„¶ç´™ä¸Š", "a": "èº"},
            {"q": "ã€Œã„’ã„§ã„ËŠã€å¸¶çš„ã€Œã„’ã„§ã„ËŠã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "æŒ¾"},
            {"q": "è«‹å¯«å‡ºã€ŒèŸ„ä¼ã€çš„ã€ŒèŸ„ã€", "a": "èŸ„"},
            {"q": "ã€Œé¥œè¶³ã€çš„ã€Œé¥œã€æ€éº¼å¯«ï¼Ÿ", "a": "é¥œ"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€è²«è€Œå…¥", "a": "é­š"},
            {"q": "ã€Œã„“ã„¨ã„›ËŠã€ç£¨çš„ã€Œã„“ã„¨ã„›ËŠã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "ç¢"},
            {"q": "è«‹å¯«å‡ºã€Œå€”å¼·ã€çš„ã€Œå€”ã€", "a": "å€”"},
            {"q": "ã€Œå˜®å¨ã€çš„ã€Œå˜®ã€æ€éº¼å¯«ï¼Ÿ", "a": "å˜®"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€ä¸å–®è¡Œ", "a": "ç¦"},
            {"q": "ã€Œã„ã„§ã„¡Ë‹ã€ç–¾çš„ã€Œã„ã„§ã„¡Ë‹ã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "ç—¼"},
            {"q": "è«‹å¯«å‡ºã€Œç¶ºéº—ã€çš„ã€Œç¶ºã€", "a": "ç¶º"},
            {"q": "ã€ŒèºŠèº‡ã€çš„ã€Œèº‡ã€æ€éº¼å¯«ï¼Ÿ", "a": "èº‡"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€ç¾½è€Œæ­¸", "a": "é©"},
            {"q": "ã€Œã„ã„§ã„ Ë‡ã€å€–çš„ã€Œã„ã„§ã„ Ë‡ã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "åƒ¥"},
            {"q": "è«‹å¯«å‡ºã€Œå—”æ€ªã€çš„ã€Œå—”ã€", "a": "å—”"},
            {"q": "ã€Œéœæ™‚ã€çš„ã€Œéœã€æ€éº¼å¯«ï¼Ÿ", "a": "éœ"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€‡ã€ä¸å¿˜", "a": "å¿µå¿µ"},
            {"q": "ã€Œã„’ã„§ã„£ã€è³çš„ã€Œã„’ã„§ã„£ã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "æ¬£"},
            {"q": "è«‹å¯«å‡ºã€Œçª˜è¿«ã€çš„ã€Œçª˜ã€", "a": "çª˜"},
            {"q": "ã€Œè©†æ¯€ã€çš„ã€Œè©†ã€æ€éº¼å¯«ï¼Ÿ", "a": "è©†"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€ä¸åï¼Œå¿«ä¸ç‚ºå¿«", "a": "ä¸€"},
            {"q": "ã€Œã„‹ã„§Ë‡ã€ç¨±çš„ã€Œã„‹ã„§Ë‡ã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "æ“¬"},
            {"q": "è«‹å¯«å‡ºã€Œè­´è²¬ã€çš„ã€Œè­´ã€", "a": "è­´"},
            {"q": "ã€Œç™±ç˜“ã€çš„ã€Œç™±ã€æ€éº¼å¯«ï¼Ÿ", "a": "ç™±"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€è½ä¸æ˜", "a": "ä¸‹"},
            {"q": "ã€Œã„…ã„›ËŠã€å–çš„ã€Œã„…ã„›ËŠã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "å‰"},
            {"q": "è«‹å¯«å‡ºã€Œå•œæ³£ã€çš„ã€Œå•œã€", "a": "å•œ"},
            {"q": "ã€Œæ…«æ¿ã€çš„ã€Œæ…«ã€æ€éº¼å¯«ï¼Ÿ", "a": "æ…«"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€è½æœ‰è‡´", "a": "éŒ¯"},
            {"q": "ã€Œã„ã„¨ã„ŸË‡ã€è«§çš„ã€Œã„ã„¨ã„ŸË‡ã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "è©¼"},
            {"q": "è«‹å¯«å‡ºã€Œè¸¹è¸ã€çš„ã€Œè¸¹ã€", "a": "è¸¹"},
            {"q": "ã€Œè³‘ç½ã€çš„ã€Œè³‘ã€æ€éº¼å¯«ï¼Ÿ", "a": "è³‘"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€ä¸ç¶“å¿ƒ", "a": "æ¼«"},
            {"q": "ã€Œã„‰ã„§ã„ËŠã€æ¬¡çš„ã€Œã„‰ã„§ã„ËŠã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "è¿­"},
            {"q": "è«‹å¯«å‡ºã€Œæ•·è¡ã€çš„ã€Œæ•·ã€", "a": "æ•·"},
            {"q": "ã€Œèºå‹•ã€çš„ã€Œèºã€æ€éº¼å¯«ï¼Ÿ", "a": "èº"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€æ¯ç›¸é—œ", "a": "æ¯"},
            {"q": "ã€Œã„™ã„¨Ë‹ã€ç„¶èµ·æ•¬çš„ã€Œã„™ã„¨Ë‹ã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "è‚…"},
            {"q": "è«‹å¯«å‡ºã€Œè´…è¿°ã€çš„ã€Œè´…ã€", "a": "è´…"},
            {"q": "ã€Œå˜ˆé›œã€çš„ã€Œå˜ˆã€æ€éº¼å¯«ï¼Ÿ", "a": "å˜ˆ"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€ç‚ºè§€æ­¢", "a": "å˜†"},
            {"q": "ã€Œã„’ã„©ã„¢Ë‹ã€éº—çš„ã€Œã„’ã„©ã„¢Ë‹ã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "çµ¢"},
            {"q": "è«‹å¯«å‡ºã€Œæ‚–è«–ã€çš„ã€Œæ‚–ã€", "a": "æ‚–"},
            {"q": "ã€Œæˆ•å®³ã€çš„ã€Œæˆ•ã€æ€éº¼å¯«ï¼Ÿ", "a": "æˆ•"},
            {"q": "æˆèªå¡«ç©ºï¼šã€Œã€‡ã€é“è€Œè¡Œ", "a": "èƒŒ"},
            {"q": "ã€Œã„”ã„¢Ë‹ã€æŠ–çš„ã€Œã„”ã„¢Ë‹ã€æ­£ç¢ºå¯«æ³•ï¼Ÿ", "a": "é¡«"},
            {"q": "è«‹å¯«å‡ºã€Œè¸‰è¹Œã€çš„ã€Œè¸‰ã€", "a": "è¸‰"}
        ];

        let peer;
        let hostConn;
        let currentQuestionIndex = 0;

        document.getElementById('connectBtn').addEventListener('click', connectToHost);
        document.getElementById('nextQuestionBtn').addEventListener('click', nextQuestion);

        function connectToHost() {
            const hostId = document.getElementById('hostIdInput').value.trim();
            if (!hostId || hostId.length !== 4 || !/^\d+$/.test(hostId)) {
                alert('è«‹è¼¸å…¥ 4 ä½æ•¸å­— ID');
                return;
            }

            updateStatus('æ­£åœ¨é€£ç·š...');

            peer = new Peer();
            peer.on('open', (id) => {
                hostConn = peer.connect(hostId);

                hostConn.on('open', () => {
                    hostConn.send({
                        type: 'identify',
                        role: 'admin'
                    });

                    updateStatus('å·²æˆåŠŸé€£ç·šï¼', true);
                    document.getElementById('connectionPanel').style.display = 'none';
                    document.getElementById('controlPanel').classList.add('active');
                });

                hostConn.on('data', (data) => {
                    handleIncomingData(data);
                });

                hostConn.on('error', (err) => {
                    console.error('Connection error:', err);
                    updateStatus('é€£ç·šéŒ¯èª¤ï¼š' + err.message);
                });
            });

            peer.on('error', (err) => {
                console.error('Peer error:', err);
                updateStatus('éŒ¯èª¤ï¼š' + err.message);
            });
        }

        function handleIncomingData(data) {
            if (data.type === 'appealNotification') {
                showAppeal(data.playerNumber);
            }
        }

        function nextQuestion() {
            if (currentQuestionIndex >= QUESTIONS.length) {
                alert('æ‰€æœ‰é¡Œç›®å·²å®Œæˆï¼');
                return;
            }

            const question = QUESTIONS[currentQuestionIndex];
            
            // æ›´æ–°é¡¯ç¤º
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('questionText').textContent = question.q;
            document.getElementById('correctAnswer').textContent = question.a;
            document.getElementById('questionDisplay').style.display = 'block';
            
            // æ›´æ–°é€²åº¦æ¢
            const progress = ((currentQuestionIndex + 1) / QUESTIONS.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';

            // æ¸…ç©ºé¸æ‰‹ç‹€æ…‹
            for (let i = 1; i <= 3; i++) {
                document.getElementById(`answer${i}`).textContent = '---';
                document.getElementById(`player${i}Status`).classList.remove('appeal');
                document.getElementById(`appeal${i}`).style.display = 'none';
                document.getElementById(`override${i}`).style.display = 'none';
            }

            // ç™¼é€åˆ°ä¸»æ§ç«¯
            if (hostConn && hostConn.open) {
                hostConn.send({
                    type: 'nextQuestion',
                    questionIndex: currentQuestionIndex
                });
            }

            currentQuestionIndex++;
        }

        function showAppeal(playerNumber) {
            document.getElementById(`player${playerNumber}Status`).classList.add('appeal');
            document.getElementById(`appeal${playerNumber}`).style.display = 'inline-block';
            document.getElementById(`override${playerNumber}`).style.display = 'flex';
        }

        function overridePlayer(playerNumber, correct) {
            if (hostConn && hostConn.open) {
                hostConn.send({
                    type: 'override',
                    playerNumber: playerNumber,
                    correct: correct
                });
            }

            document.getElementById(`player${playerNumber}Status`).classList.remove('appeal');
            document.getElementById(`appeal${playerNumber}`).style.display = 'none';
            document.getElementById(`override${playerNumber}`).style.display = 'none';
        }

        function updateStatus(message, connected = false) {
            const statusEl = document.getElementById('statusMessage');
            statusEl.textContent = message;
            if (connected) {
                statusEl.classList.add('connected');
            } else {
                statusEl.classList.remove('connected');
            }
        }
    </script>
</body>
</html>
